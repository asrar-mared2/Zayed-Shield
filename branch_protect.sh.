#!/bin/bash
# Ø³ÙƒØ±ÙŠØ¨Øª Ø­Ù…Ø§ÙŠØ© ÙØ±Ø¹ ÙƒØ§Ù…Ù„Ø© Ø¨Ø§Ø³Ù… "Ø§Ù„Ø¥Ù†Ù‚Ø§Ø°" Ù„Ù…Ø³ØªØ®Ø¯Ù… asrar-mared ÙÙ‚Ø·

REPO="asrar-mared/Zayed-Shield"
BRANCH="main"
RULE_SET_NAME="Ø§Ù„Ø¥Ù†Ù‚Ø§Ø°"

echo "ğŸ”’ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ $RULE_SET_NAME Ø¹Ù„Ù‰ $BRANCH ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ $REPO ..."

gh api -X PUT /repos/$REPO/branches/$BRANCH/protection \
  -F required_status_checks.strict=true \
  -F required_status_checks.contexts[]=ci/build \
  -F enforce_admins=true \
  -F required_pull_request_reviews.dismiss_stale_reviews=true \
  -F required_pull_request_reviews.require_code_owner_reviews=true \
  -F restrictions.users="asrar-mared" \
  -F restrictions.teams="" \
  -F allow_force_pushes=false \
  -F allow_deletions=false

echo "âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙØ±Ø¹ $BRANCH Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© $RULE_SET_NAME"
echo "ğŸ” ÙƒÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ù…ÙØ¹Ù‘Ù„Ø©: ØªØ§Ø±ÙŠØ® Ø®Ø·ÙŠØŒ Pull RequestØŒ CI/CDØŒ ØªÙˆÙ‚ÙŠØ¹Ø§ØªØŒ Ù…Ù†Ø¹ Force Push ÙˆØ§Ù„Ø­Ø°ÙØŒ Ù…Ø±Ø§Ø¬Ø¹Ø© CopilotØŒ Ø¥Ù„Ø®."
